## ----setup, include=FALSE, results='asis', warning=FALSE----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
knitr::opts_chunk$set(echo = TRUE, tidy = TRUE, warning = FALSE,
message = FALSE)
options(width = 800)

## ----Install, eval=FALSE, message=FALSE, warning=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  if (!requireNamespace("BiocManager", quietly = TRUE))
#  install.packages("BiocManager")
#  
#  BiocManager::install("TimiRGeN")

## ----Load libs, echo=TRUE, message=FALSE, results='hide'----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
libstoinst <- c("dplyr", "gtools", "rWikiPathways", "tidyr", "stringr",
"tidyverse", "clusterProfiler", "biomaRt", "org.Hs.eg.db", "org.Mm.eg.db", 
"RCy3", "ggplot2", "TimiRGeN", "igraph", "Mfuzz", "readxl", 
"MultiAssayExperiment")

lapply(libstoinst, require, character.only = TRUE)

## ---- echo=FALSE, warning=FALSE, error=FALSE----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
library(knitr)
library(kableExtra)

## ----Load Fibrosis data-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
mm_miR -> miR

mm_mRNA -> mRNA

## ----MAE, message=FALSE-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
StartObject(miR = miR, mRNA = mRNA) -> Data

## ----retrieveID data for miR data, warning=FALSE, message=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
getIDs_miR_mouse(MAE = Data, miR = Data@ExperimentList$miR)  -> Data

getIDs_mRNA_mouse(MAE = Data, mRNA = Data@ExperimentList$mRNA) -> Data

## ----CombinGenes, error=FALSE, warning=FALSE----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CombineGenes(miR_data = Data@ExperimentList$miR, mRNA_data = 
Data@ExperimentList$mRNA) -> Data@ExperimentList$genetic_data

GenesList(method = "c", genetic_data = Data@ExperimentList$genetic_data,
timeString = "D") -> Data@metadata$genelist

SignificantVals(method = "c", geneList = Data@metadata$genelist, maxVal = 0.05,
stringVal = "adjPVal") -> Data@metadata$filtered_genelist

## ----add entrezIDs, warning=FALSE, error=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
AddIDs(method="c", 
filtered_genelist=Data@metadata$filtered_genelist, 
miR_IDs=Data@ExperimentList$miR_entrez, 
mRNA_IDs=Data@ExperimentList$mRNA_entrez)->Data@metadata$gene_entrez

eNames(method = "c", gene_IDs = Data@metadata$gene_entrez,
ID_Column = 4) -> Data@metadata$e_list 

## ----downloadGTM, message=FALSE, warning=FALSE, eval=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  dloadGMT(MAE = Data, speciesInitials = "Mm") -> Data

## ----message=FALSE, warning=FALSE, echo=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Mm_gmt@ExperimentList$path_gene -> Data@ExperimentList$path_gene
Mm_gmt@ExperimentList$path_name -> Data@ExperimentList$path_name
Mm_gmt@ExperimentList$path_data -> Data@ExperimentList$path_data

## ----EnrichWiki, warning=FALSE, message=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
EnrichWiki(method = "c",
e_list = Data@metadata$e_list,
orgDB = org.Mm.eg.db, 
path_gene = Data@ExperimentList$path_gene, 
path_name = Data@ExperimentList$path_name, 
ID = "ENTREZID", 
universe = Data@ExperimentList$path_gene$gene) -> Data@metadata$sigwiki

## ----Quickbardot, warning=FALSE, message=FALSE, eval=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  SavePlots(largeList = Data@metadata$sigwiki, maxInt = 5, quickType = Quickdot,
#  fileType = "jpg")

## ----echo=FALSE, out.width = "400px",out.height= "350px", dpi=10--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
knitr::include_graphics("D1_wikipathways.jpg")
knitr::include_graphics("D2_wikipathways.jpg")

## ----echo=FALSE, out.width = "400px", out.height="350px", dpi=10--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
knitr::include_graphics("D3_wikipathways.jpg")
knitr::include_graphics("D7_wikipathways.jpg")

## ----echo=FALSE, out.width = "400px", out.height="350px", dpi=10--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
knitr::include_graphics("D14_wikipathways.jpg")

## ----wikilist, eval=FALSE, message=FALSE, warning=FALSE-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  WikiList(stringSpecies = "Mus musculus", stringSymbol = "L"
#  ) -> Data@metadata$wlist

## ----wikilist_true, echo=FALSE, message=FALSE, warning=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
w_list -> Data@metadata$wlist

## ----Wikimatriz, message=FALSE, warning=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
WikiMatrix(e_list = Data@metadata$e_list, wp_list = Data@metadata$wlist
) -> Data@ExperimentList$Wmat

## ----Percent, message=FALSE, warning=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
TurnPercent(wikiMatrix = Data@ExperimentList$Wmat, rowInt = 6
) -> Data@ExperimentList$Pmat

## ----CreateClusters, message=FALSE, warning=FALSE, fig.align ="center",dpi=80-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CreateClusters(MAE =  Data, 
method = "c", Percent_matrix = Data@ExperimentList$Pmat,
no.clusters = 12, Variance = 0.99) -> Data

## ----ClusterCheck, message=FALSE, warning=FALSE, fig.align="center", dpi=80---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ClusterCheck(Clusters = Data@metadata$Clusters, W = FALSE)

## ----plotfuzz, message=FALSE, eval=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  Quickfuzz(Mfuzzdata = Data@ExperimentList$MfuzzData,
#  Clusters = Data@metadata$Clusters, W = FALSE)

## ----FUZZ, echo=FALSE, out.width="800px", out.height="600px", dpi=15----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
knitr::include_graphics("fuzz.jpeg")

## ----warning=FALSE, message=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ReturnCluster(ClusterData = Data@ExperimentList$ClusterData, 
which.cluster = 12,
fit.cluster = 0.9) -> Data@ExperimentList$CLUST12_0.9

## ----warning=FALSE, message=FALSE, eval=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  getXrefList(pathway = "WP200", "L")
#  getPathwayInfo("WP200")

## ----Express, warning=FALSE, message=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Express(df = Data@ExperimentList$miR, dataType = "Log2FC",
genes_ID = Data@ExperimentList$miR_entrez, idColumn = "GENENAME"
) -> Data@ExperimentList$miRNA_log2fc

Express(df = Data@ExperimentList$mRNA, dataType = "Log2FC",
genes_ID = Data@ExperimentList$mRNA_entrez, idColumn = "GENENAME"
) -> Data@ExperimentList$mRNA_log2fc

## ----wikimRNA, warning=FALSE, message=FALSE-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ReduceWiki(path_data =Data@ExperimentList$path_data, 
stringWiki = "Complement and Coagulation Cascades"
) -> Data@ExperimentList$Complement

WikimRNA(mRNA_express = Data@ExperimentList$mRNA_log2fc, 
SingleWiki = Data@ExperimentList$Complement
) -> Data@ExperimentList$GenesofInterest

## ----Correlation, warning=FALSE, message=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
miR_mRNA_IntDF(miR_express = Data@ExperimentList$miRNA_log2fc,
GenesofInterest = Data@ExperimentList$GenesofInterest, 
maxInt = 5) -> Data@ExperimentList$Corr_matrix

## ----Targetscans data, message=FALSE, warning=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
dloadTargetScans() -> Data@ExperimentList$TargetScans
TargetScans_data(targetScan = Data@ExperimentList$TargetScans, species = "mmu"
) -> Data@ExperimentList$TargetScans_res

## ----miRDB data, message=FALSE, warning=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
dloadmiRDB() -> Data@ExperimentList$miRDB
miRDB_data(miRDB = Data@ExperimentList$miRDB, species = "mmu", 
orgDB = org.Mm.eg.db) -> Data@ExperimentList$miRDB_res

## ----miRtarBase data,  message=FALSE, warning=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
dloadmiRTarBase() -> Data@ExperimentList$miRTarBase
miRTarBase_data(mirtarbase = Data@ExperimentList$miRTarBase, 
species = "mmu") -> Data@ExperimentList$miRTarBase_res

## ----Datamining, message=FALSE, warning=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataMiningMatrix(corrTable = Data@ExperimentList$Corr_matrix, 
targetscan = Data@ExperimentList$TargetScans_res, 
mirdb = Data@ExperimentList$miRDB_res,
mirtarbase = Data@ExperimentList$miRTarBase_res
) -> Data@ExperimentList$mining_matrix                    

## ----MatrixFilter, warning=FALSE, message=FALSE-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
MatrixFilter(miningMatrix = Data@ExperimentList$mining_matrix,
NegativeOnly = TRUE, THRESHOLD = 2, PredictedOnly = FALSE, maxCor = -0.5
) -> Data@ExperimentList$filt_df

## ----CreateNetwork, message=FALSE, warning=FALSE, eval=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  MakeNet(filt_df = Data@ExperimentList$filt_df) -> Data@metadata$net
#  
#  Quicknet(net = Data@metadata$net)

## ----netmake, echo=FALSE, dpi=8-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
knitr::include_graphics("Complement.jpeg")

## ----Makestuff----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
MakeDynamic(miR_expression = Data@ExperimentList$miRNA_log2fc, 
mRNA_expression = Data@ExperimentList$mRNA_log2fc, 
miR_IDs_adj = Data@ExperimentList$miR_entrez, Datatype = "L"
) -> Data@ExperimentList$Dynamics

write.csv(Data@ExperimentList$Dynamics, "Dynamics.csv", row.names = TRUE,
quote = FALSE)

MakeMapp(filt_df = Data@ExperimentList$filt_df,
miR_IDs_adj = Data@ExperimentList$miR_entrez, Datatype = "L"
) -> Data@ExperimentList$MAPP

write.table(Data@ExperimentList$MAPP, "MAPP.txt", quote = FALSE,
row.names = FALSE, col.names = FALSE, sep = "\t")

## ----cytoscape, message=FALSE, warning=FALSE, eval=FALSE----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  cytoscapePing()
#  
#  CytoMake(interaction_data = Data@ExperimentList$filt_df,
#  titleString = 'Complement+Coagulation',
#  collectionString = 'PathwaysforKidneyFibrosis')

## ----loadmouse, message=FALSE, warning=FALSE----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
hs_miR -> miR
rownames(miR) <- gsub(rownames(miR), pattern = "\\.", replacement = "-")
rownames(miR) <- sub("-$", "*", rownames(miR))
hs_mRNA -> mRNA

StartObject(miR = miR, mRNA = mRNA) -> MAE

getIDs_miR_human(MAE = MAE, miR = MAE@ExperimentList$miR) -> MAE
getIDs_mRNA_human(MAE = MAE, mRNA = MAE@ExperimentList$mRNA, 
mirror = "useast") -> MAE

## ----AddPrefix, message=FALSE, warning=FALSE----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
AddPrefix(gene_df = MAE@ExperimentList$miR, prefixString = "miR"
) -> MAE@ExperimentList$miR_p
AddPrefix(gene_df = MAE@ExperimentList$mRNA, prefixString = "mRNA"
) -> MAE@ExperimentList$mRNA_p

## ----siggenes, warning=FALSE, message=FALSE-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
GenesList(method = "s",miR_data = MAE@ExperimentList$miR_p,
mRNA_data = MAE@ExperimentList$mRNA_p) -> MAE@metadata$genelist

SignificantVals(method = "s", geneList = MAE@metadata$genelist, maxVal = 0.05,
stringVal = "adjPVal") -> MAE@metadata$filtered_genelist

## ----getensemblids, warning=FALSE, message=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
AddIDs(method="s",filtered_genelist=MAE@metadata$filtered_genelist, 
miR_IDs=MAE@ExperimentList$miR_entrez,
mRNA_IDs=MAE@ExperimentList$mRNA_entrez) -> MAE@metadata$entrez_genes 

eNames(method = "s",gene_IDs = MAE@metadata$entrez_genes,
ID_Column = 4) -> MAE@metadata$e_list

## ----echo=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
w_list_human-> MAE@metadata$w_list

## ----eval=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  WikiList(stringSpecies = "Homo sapiens",stringSymbol = "L"
#  ) -> MAE@metadata$wlist

## ----warning=FALSE, message=FALSE, echo=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
WikiMatrix(e_list = MAE@metadata$e_list, wp_list = MAE@metadata$w_list
) -> MAE@ExperimentList$Wmat

TurnPercent(wikiMatrix = MAE@ExperimentList$Wmat, rowInt = 7
) -> MAE@ExperimentList$Pmat

## ----warning=FALSE, message=FALSE, eval=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  CreateClusters(method = "s", MAE = MAE,
#  Percent_matrix = MAE@ExperimentList$Pmat, no.clusters = 8,
#  Data_string = "mRNA", Variance = 0.5) -> MAE
#  
#  ClusterCheck(Clusters = Clusters, W = FALSE)
#  
#  Quickfuzz(Mfuzzdata = MAE@ExperimentList$MfuzzData,
#  Clusters = MAE@metadata$Clusters, W = FALSE)
#  
#  ReturnCluster( ClusterData = MAE@ExperimentList$ClusterData, which.cluster = 3,
#  fit.cluster = 0.75)) -> MAE@ExperimentList$CLUSTER3

## ----eval=FALSE, message=FALSE, warning=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  dloadGMT(MAE = MAE, speciesInitials = "Hs") -> MAE
#  
#  EnrichWiki(method = "s", e_list = MAE@metadata$e_list,orgDB = org.Hs.eg.db,
#  path_gene = MAE@ExperimentList$path_gene,
#  path_name = MAE@ExperimentList$path_name, ID = "ENTREZID",
#  universe = MAE@ExperimentList$path_gene$gene) -> MAE@metadata$sigwiki

## ----loadhuman, warning=FALSE, message=FALSE----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
hs_miR -> miR

hs_mRNA -> mRNA

## ----tweak, warning=FALSE, message=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
gsub(rownames(miR), pattern = "\\.", replacement =  "-") -> rownames(miR)
rownames(miR) <- sub("-$", "*", rownames(miR))

## ----gethuman, warning=FALSE, message=FALSE-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
getIDs_miR_human(MAE = MAE, miR = MAE@ExperimentList$miR) -> MAE

getIDs_mRNA_human(MAE = MAE, mRNA = MAE@ExperimentList$mRNA, 
mirror = "useast") -> MAE

## ----loadmousetohuman, message=FALSE, warning=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
mm_miR -> miR

mm_mRNA -> mRNA

StartObject(miR = miR, mRNA = mRNA) -> MAE

getIDs_miR_mousetohuman(MAE, MAE@ExperimentList$miR, mirror = 'useast') -> MAE

getIDs_mRNA_mousetohuman(MAE, MAE@ExperimentList$mRNA, mirror = 'useast'
) -> MAE

## ----message=FALSE, warning=FALSE, echo=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Mm_gmt@ExperimentList$path_gene -> MAE@ExperimentList$path_gene
Mm_gmt@ExperimentList$path_name -> MAE@ExperimentList$path_name
Mm_gmt@ExperimentList$path_data -> MAE@ExperimentList$path_data

## ----warning=FALSE, message=FALSE, eval=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  dloadGMT(MAE = MAE, speciesInitials = "Mm") -> MAE

## ----warning=FALSE, message=FALSE, eval=TRUE----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
GMT_ensembl(MAE = MAE, path_gene = MAE@ExperimentList$path_gene,
path_data = MAE@ExperimentList$path_data, orgDB = org.Mm.eg.db) -> MAE

## ----mRNAonly, warning=FALSE, message=FALSE, eval=TRUE, fig.align="center"----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
mm_mRNA -> mRNA
StartObject(miR = NULL, mRNA = mRNA) -> Data
getIDs_mRNA_mouse(MAE = Data, mRNA = Data@ExperimentList$mRNA,
mirror = 'useast') -> Data

GenesList(method = 'c', genetic_data = Data@ExperimentList$mRNA,
timeString = 'D') -> Data@metadata$genelist

SignificantVals(method = 'c', geneList = Data@metadata$genelist, maxVal = 0.05, 
stringVal = 'adjPVal') -> Data@metadata$filtered_genelist

AddIDs(method='c',filtered_genelist=Data@metadata$filtered_genelist,
mRNA_IDs=Data@ExperimentList$mRNA_entrez, 
miR_IDs=Data@ExperimentList$mRNA_entrez)->Data@metadata$entrez_data

eNames(method = 'c', gene_IDs = Data@metadata$entrez_data,
ID_Column = 4) -> Data@metadata$elist

## ----warning=FALSE, message=FALSE, eval=FALSE, fig.align="center"-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  dloadGMT(MAE = Data, speciesInitials = "Mm") -> Data

## ----message=FALSE, warning=FALSE, echo=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Mm_gmt@ExperimentList$path_gene -> Data@ExperimentList$path_gene
Mm_gmt@ExperimentList$path_name -> Data@ExperimentList$path_name
Mm_gmt@ExperimentList$path_data -> Data@ExperimentList$path_data

## ----warning=FALSE, message=FALSE, eval=TRUE, fig.align="center"--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
EnrichWiki(method = 'c', e_list = Data@metadata$elist,
orgDB = org.Mm.eg.db, path_gene = Data@ExperimentList$path_gene,
path_name = Data@ExperimentList$path_name, ID = 'ENTREZID', 
universe = Data@ExperimentList$path_gene$gene) -> Data@metadata$sigwiki

## ----eval=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  Quickbar(X = Data@metadata$sigwiki[[1]], Y = Data@metadata$sigwiki[1])

## ----fig.align="center",out.width="300px",out.height="300px",echo=FALSE,dpi=10------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
knitr::include_graphics("quickbar.jpeg")

